<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vapi AI Assistant</title>
    <!-- Include the Vapi SDK using the correct URL -->
    <script src="https://cdn.jsdelivr.net/gh/VapiAI/html-script-tag@latest/dist/assets/index.js"></script>
</head>
<body>
    <script>
        // Your assistant code here
        var vapiInstance = null;

        function getQueryParam(param) {
            let urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Retrieve parameters from the query string
        const apiKey = getQueryParam('apiKey') || '<your_public_api_key>';
        const assistant = getQueryParam('assistant') || '<assistant_id>';
        const title = getQueryParam('title') || 'Have a quick question?';
        const subtitle = getQueryParam('subtitle') || 'Talk with our AI assistant';
        const parentOrigin = getQueryParam('parentOrigin') || '*';

        // Configure the button
        const buttonConfig = {
            // ... your existing button configuration ...
        };

        // Initialize the assistant when the SDK is loaded
        window.addEventListener('load', function() {
            if (window.vapiEventListenersAdded) {
                return;
            }
            window.vapiEventListenersAdded = true;

            // Initialize vapiInstance using the web snippet approach
            vapiInstance = window.vapiSDK.run({
                apiKey: apiKey, // Mandatory
                assistant: assistant, // Mandatory
                config: buttonConfig, // Optional
            });

            console.log("Assistant: vapiInstance created:", vapiInstance);

            // ... rest of your code (event listeners, message handling, etc.) ...
        });
    </script>
</body>
</html>
